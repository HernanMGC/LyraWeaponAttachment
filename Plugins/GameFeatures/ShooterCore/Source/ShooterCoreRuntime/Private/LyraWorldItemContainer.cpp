// Fill out your copyright notice in the Description page of Project Settings.

// Class
#include "LyraWorldItemContainer.h"

// Unreal Engine
#include "Components/GameFrameworkComponentManager.h"

////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////

ALyraWorldItemContainer::ALyraWorldItemContainer()
{
	bReplicates = true;
}

////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////

void ALyraWorldItemContainer::GatherInteractionOptions(const FInteractionQuery& InteractQuery,
	FInteractionOptionBuilder& InteractionBuilder)
{
	InteractionBuilder.AddInteractionOption(Option);
}

////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////

void ALyraWorldItemContainer::BeginPlay()
{
	Super::BeginPlay();

	if (UGameFrameworkComponentManager* componentManager = GetGameInstance()->GetSubsystem<UGameFrameworkComponentManager>())
	{
		componentManager->AddReceiver(this);
	}
}

////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////

void ALyraWorldItemContainer::EndPlay(const EEndPlayReason::Type EndPlayReason)
{
	if (UGameInstance* gameInstance = GetGameInstance())
	{
		if (UGameFrameworkComponentManager* componentManager = gameInstance->GetSubsystem<UGameFrameworkComponentManager>())
		{
			componentManager->RemoveReceiver(this);
		}
	}
	
	Super::EndPlay(EndPlayReason);
}

////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////
